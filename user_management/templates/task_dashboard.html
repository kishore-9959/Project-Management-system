<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task List</title>
    <!-- Bootstrap CSS (you can use CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
             body {
            background-color: #f8f9fa;
        }

        /* Header Section with Background */
        .header-background {
            background-image: url('https://images.unsplash.com/photo-1542744094-3a31f272c490'); /* Replace with custom image */
            background-size: cover;
            background-position: center;
            padding: 60px 0;
            text-align: center;
            color: rgb(208, 25, 25);
        }

        .header-background h1 {
            font-weight: bold;
            font-size: 2.5rem;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.5);
        }

        /* Navbar Styles */
        .navbar-brand {
            font-weight: bold;
        }
        .card {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
        .card-header {
            font-weight: bold;
            text-align: center;
        }
        .task-count {
            font-size: 18px;
            margin-bottom: 10px;
        }
        .pending { color: #dc3545; } /* Red */
        .inprogress { color: #ffc107; } /* Yellow */
        .completed { color: #28a745; } /* Green */
    </style>
</head>
<body>


    <!-- Header Section -->
    <div class="header-background">
        <h1>POLYCAB Project Management System</h1>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">POLYCAB PMS</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'user_list_admin' %}">
                            <i class="bi bi-people-fill"></i> User Management
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'task_list' %}">
                            <i class="bi bi-list-check"></i> Task Management
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'logout' %}">
                            <i class="bi bi-box-arrow-right"></i> Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main container -->
    <div class="container my-5">
        <!-- Subheading for Task List -->
        <h2 class="text-center mb-4">Task List</h2>

        <!-- Back Button -->
        <a href="{% url 'admin_dashboard' %}" class="btn btn-secondary mb-4">Back to Dashboard</a>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}


        <!-- Table to display tasks -->
        <table class="table table-bordered table-striped" id="task-table">
            <thead class="table-dark">
                <tr>
                    <th>S.No</th>
                    <th>Task Name</th>
                    <th>Sub Tasks</th>
                    <th>Milestone</th>
                    <th>Assign To</th>
                    <th>State</th>
                    <th>Business Area</th>
                    <!-- <th>District</th>q -->
                    <th>Block</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for task in tasks %}
                    <tr>
                        <td>{{ task.id }}</td>
                        <td>{{ task.task_name }}</td>
                        <td>{{ task.subtasks }}</td>
                        <td>{{ task.milestone }}</td>
                        <td>{{ task.assign_to }}</td>
                        <td>{{ task.state }}</td>
                        <td>{{ task.business_area }}</td>
                        <!-- <td>{{ task.district }}</td> -->
                        <td>{{ task.block }}</td>
                        <td>{{ task.start_date }}</td>
                        <td>{{ task.end_date }}</td>
                        <td>{{ task.status }}</td>
                        <td>
                            <a href="{% url 'update_task' task.id %}" class="btn btn-warning btn-sm">Edit</a>
                            <a href="{% url 'delete_task' task.id %}" class="btn btn-danger btn-sm">Delete</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Link to create a new task -->
        <a href="{% url 'create_task' %}" class="btn btn-primary mt-3">Create New Task</a>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

   

    



<div class="container mt-5">
    <h2 class="text-center mb-4">Task Milestone Status</h2>

    <div class="row">
        {% if milestone_data %}
            {% for milestone in milestone_data %}
                {% if milestone.nil_count != 0 or milestone.inprogress_count != 0 or milestone.completed_count != 0 %}
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            {{ milestone.name }}
                        </div>
                        <div class="card-body text-center">
                            <div class="task-count pending">
                                Pending: {{ milestone.nil_count }}
                            </div>
                            <div class="task-count inprogress">
                                In Progress: {{ milestone.inprogress_count }}
                            </div>
                            <div class="task-count completed">
                                Completed: {{ milestone.completed_count }}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            {% endfor %}
        {% else %}
            <div class="col-12 text-center">
                <div class="alert alert-warning" role="alert">
                    No milestone data available.
                </div>
            </div>
        {% endif %}
    </div>
</div>



<!-- Bootstrap JS Bundle (optional) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>



<script>
    // Districts based on selected state
    const districts = {
      'AP': ['East Godavari', 'West Godavari', 'Visakhapatnam'],
      'TS': ['Hyderabad', 'Ranga Reddy', 'Khammam'],
      'KA': ['Bangalore', 'Mysuru', 'Hubballi'],
      'TN': ['Chennai', 'Coimbatore', 'Madurai'],
      'MH': ['Mumbai', 'Pune', 'Nagpur'],
      'OD': ['Bhubaneswar', 'Cuttack', 'Rourkela'],
      'RJ': ['Jaipur', 'Jodhpur', 'Udaipur'],
      'GJ': ['Ahmedabad', 'Rajkot', 'Vadodara'],
      'WB': ['Kolkata', 'Howrah', 'Siliguri'],
      'UP': ['Lucknow', 'Varanasi', 'Agra']
    };

    document.addEventListener("DOMContentLoaded", function () {
      const stateSelect = document.getElementById('state-filter');
      const districtSelect = document.getElementById('district-filter');

      function populateDistricts(state) {
        districtSelect.innerHTML = "<option value=''>Select District</option>";

        if (districts[state]) {
          districts[state].forEach(function (district) {
            const option = document.createElement("option");
            option.value = district;
            option.textContent = district;
            districtSelect.appendChild(option);
          });
        }
      }

      // Repopulate districts when state changes
      stateSelect.addEventListener('change', function () {
        populateDistricts(this.value);
      });
    });
</script>


</body>
</html>
